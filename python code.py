path=['Downloads/data/features.txt','Downloads/data/Train/','Downloads/data/Test']
import pandas
import pickle
from sklearn import svm

from sklearn.model_selection import GridSearchCV
from sklearn.metrics import accuracy_score

cols=pandas.read_table(path[0],header=None)
xtrain=pandas.read_table(path[1]+'X_train.txt',delim_whitespace=True,header=None)
ytrain=pandas.read_table(path[1]+'y_train.txt',header=None)
xtest=pandas.read_table(path[2]+'X_test.txt',delim_whitespace=True,header=None)
ytest=pandas.read_table(path[2]+'y_test.txt',header=None)

clf=svm.SVC()

params=[{'kernel': ['rbf'], 'gamma': [0.001, 0.0001], 'C': [1, 10, 100, 1000]}, {'kernel': ['linear'], 'C': [1, 10, 100, 1000]}]
model=GridSearchCV(clf,params,verbose=3)
model.fit(xtrain.as_matrix(),ytrain.as_matrix().ravel().T)

ypre=model.predict(xtest)

acs=accuracy_score(ytest,ypre)

print(model.best_params_)
print(acs)



#Output

Fitting 3 folds for each of 12 candidates, totalling 36 fits
[CV] C=1, gamma=0.001, kernel=rbf ....................................
[CV] ..... C=1, gamma=0.001, kernel=rbf, score=0.881127, total=  14.3s
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:   28.5s remaining:    0.0s
[CV] C=1, gamma=0.001, kernel=rbf ....................................
[CV] ..... C=1, gamma=0.001, kernel=rbf, score=0.852510, total=  13.9s
[Parallel(n_jobs=1)]: Done   2 out of   2 | elapsed:   55.2s remaining:    0.0s
[CV] C=1, gamma=0.001, kernel=rbf ....................................
[CV] ..... C=1, gamma=0.001, kernel=rbf, score=0.883604, total=  14.2s
[CV] C=1, gamma=0.0001, kernel=rbf ...................................
[CV] .... C=1, gamma=0.0001, kernel=rbf, score=0.710922, total=  27.5s
[CV] C=1, gamma=0.0001, kernel=rbf ...................................
[CV] .... C=1, gamma=0.0001, kernel=rbf, score=0.715058, total=  26.9s
[CV] C=1, gamma=0.0001, kernel=rbf ...................................
[CV] .... C=1, gamma=0.0001, kernel=rbf, score=0.730858, total=  24.7s
[CV] C=10, gamma=0.001, kernel=rbf ...................................
[CV] .... C=10, gamma=0.001, kernel=rbf, score=0.926283, total=   6.2s
[CV] C=10, gamma=0.001, kernel=rbf ...................................
[CV] .... C=10, gamma=0.001, kernel=rbf, score=0.897683, total=   6.5s
[CV] C=10, gamma=0.001, kernel=rbf ...................................
[CV] .... C=10, gamma=0.001, kernel=rbf, score=0.940835, total=   6.6s
[CV] C=10, gamma=0.0001, kernel=rbf ..................................
[CV] ... C=10, gamma=0.0001, kernel=rbf, score=0.881899, total=  13.0s
[CV] C=10, gamma=0.0001, kernel=rbf ..................................
[CV] ... C=10, gamma=0.0001, kernel=rbf, score=0.854826, total=  14.4s
[CV] C=10, gamma=0.0001, kernel=rbf ..................................
[CV] ... C=10, gamma=0.0001, kernel=rbf, score=0.885924, total=  13.8s
[CV] C=100, gamma=0.001, kernel=rbf ..................................
[CV] ... C=100, gamma=0.001, kernel=rbf, score=0.926283, total=   4.5s
[CV] C=100, gamma=0.001, kernel=rbf ..................................
[CV] ... C=100, gamma=0.001, kernel=rbf, score=0.920849, total=   4.6s
[CV] C=100, gamma=0.001, kernel=rbf ..................................
[CV] ... C=100, gamma=0.001, kernel=rbf, score=0.951276, total=   4.8s
[CV] C=100, gamma=0.0001, kernel=rbf .................................
[CV] .. C=100, gamma=0.0001, kernel=rbf, score=0.925125, total=   6.8s
[CV] C=100, gamma=0.0001, kernel=rbf .................................
[CV] .. C=100, gamma=0.0001, kernel=rbf, score=0.899228, total=   6.0s
[CV] C=100, gamma=0.0001, kernel=rbf .................................
[CV] .. C=100, gamma=0.0001, kernel=rbf, score=0.940062, total=   6.4s
[CV] C=1000, gamma=0.001, kernel=rbf .................................
[CV] .. C=1000, gamma=0.001, kernel=rbf, score=0.928213, total=   3.5s
[CV] C=1000, gamma=0.001, kernel=rbf .................................
[CV] .. C=1000, gamma=0.001, kernel=rbf, score=0.923166, total=   3.8s
[CV] C=1000, gamma=0.001, kernel=rbf .................................
[CV] .. C=1000, gamma=0.001, kernel=rbf, score=0.952823, total=   4.1s
[CV] C=1000, gamma=0.0001, kernel=rbf ................................
[CV] . C=1000, gamma=0.0001, kernel=rbf, score=0.924739, total=   3.8s
[CV] C=1000, gamma=0.0001, kernel=rbf ................................
[CV] . C=1000, gamma=0.0001, kernel=rbf, score=0.918919, total=   4.1s
[CV] C=1000, gamma=0.0001, kernel=rbf ................................
[CV] . C=1000, gamma=0.0001, kernel=rbf, score=0.951276, total=   4.3s
[CV] C=1, kernel=linear ..............................................
[CV] ............... C=1, kernel=linear, score=0.926283, total=   3.2s
[CV] C=1, kernel=linear ..............................................
[CV] ............... C=1, kernel=linear, score=0.920463, total=   3.5s
[CV] C=1, kernel=linear ..............................................
[CV] ............... C=1, kernel=linear, score=0.952049, total=   3.7s
[CV] C=10, kernel=linear .............................................
[CV] .............. C=10, kernel=linear, score=0.923196, total=   3.1s
[CV] C=10, kernel=linear .............................................
[CV] .............. C=10, kernel=linear, score=0.917375, total=   3.4s
[CV] C=10, kernel=linear .............................................
[CV] .............. C=10, kernel=linear, score=0.947796, total=   3.6s
[CV] C=100, kernel=linear ............................................
[CV] ............. C=100, kernel=linear, score=0.924354, total=   3.0s
[CV] C=100, kernel=linear ............................................
[CV] ............. C=100, kernel=linear, score=0.916988, total=   3.4s
[CV] C=100, kernel=linear ............................................
[CV] ............. C=100, kernel=linear, score=0.943155, total=   3.6s
[CV] C=1000, kernel=linear ...........................................
[CV] ............ C=1000, kernel=linear, score=0.924354, total=   3.0s
[CV] C=1000, kernel=linear ...........................................
[CV] ............ C=1000, kernel=linear, score=0.916988, total=   3.4s
[CV] C=1000, kernel=linear ...........................................
[CV] ............ C=1000, kernel=linear, score=0.943155, total=   3.6s
[Parallel(n_jobs=1)]: Done  36 out of  36 | elapsed:  8.9min finished
{'C': 1000, 'gamma': 0.001, 'kernel': 'rbf'}
0.952877925364





